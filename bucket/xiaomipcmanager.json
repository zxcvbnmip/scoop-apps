{
    "version": "4.3.0.1881",
    "description": "小米电脑管家，「人车家全生态」让设备实时动态组网，所有设备协同如一个整体，带来划时代互联体验",
    "homepage": "https://hyperos.mi.com/continuity",
    "license": "Proprietary",
    "notes": "非常规安装，可能会破坏系统，不保证能用",
    "architecture": {
        "64bit": {
            "url": "https://cdn.cnbj1.fds.api.mi-img.com/ota-packages/uhs__XiaomiPCManager_hyperos2_4.3.0.1881_a14d90c7.exe#/installer.exe",
            "hash": "58f717249028749d8e49c518079ad831711fee597be6a750e33c0fff6a50d2eb"
        }
    },
    "installer": {
        "script": [
            "Expand-7zipArchive -Path \"$dir\\installer.exe\" -DestinationPath \"$dir\\InstallerTemp\" -Removal -Switches '-t#'",
            "",
            "Get-ChildItem -Path \"$dir\\InstallerTemp\" -Filter \"*.7z\" | ForEach-Object {",
            "    Expand-7zipArchive -Path $_.FullName -DestinationPath \"$dir\\$version\" -Overwrite 'All'",
            "}",
            "Remove-Item -Path \"$dir\\InstallerTemp\" -Recurse -Force -ErrorAction SilentlyContinue | Out-Null",
            "",
            "Copy-Item -Path \"$dir\\$version\\Launch.exe\" -Destination \"$dir\\Launch.exe\" -Force -ErrorAction SilentlyContinue | Out-Null",
            "Copy-Item -Path \"$dir\\$version\\.run\" -Destination \"$dir\\.run\" -Force -ErrorAction SilentlyContinue | Out-Null",
            "",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\*\\shellex\\ContextMenuHandlers\\MiDropExtMenu\" /ve /t REG_SZ /d \"{1bca9901-05c3-4d01-8ad4-78da2eac9b3f}\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\AppID\\{846d36ff-1cb4-4d2c-8d90-b292f8b5a1d0}\" /v \"LocalService\" /t REG_SZ /d \"MAFSvr\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\CLSID\\{1bca9901-05c3-4d01-8ad4-78da2eac9b3f}\" /ve /t REG_SZ /d \"CMiDropContextMenuExt\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\CLSID\\{1bca9901-05c3-4d01-8ad4-78da2eac9b3f}\\InprocServer32\" /ve /t REG_SZ /d \"$dir\\$version\\MiDropShellExt.dll\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\CLSID\\{1bca9901-05c3-4d01-8ad4-78da2eac9b3f}\\InprocServer32\" /v \"ThreadingModel\" /t REG_SZ /d \"Apartment\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\CLSID\\{1bca9901-05c3-4d01-8ad4-78da2eac9b3f}\\Programmable\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\CLSID\\{1bca9901-05c3-4d01-8ad4-78da2eac9b3f}\\TypeLib\" /ve /t REG_SZ /d \"{879ec5c6-6c77-4ec5-9725-9096df0aa7ba}\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\CLSID\\{1bca9901-05c3-4d01-8ad4-78da2eac9b3f}\\Version\" /ve /t REG_SZ /d \"1.0\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\Directory\\shellex\\ContextMenuHandlers\\MiDropExtMenu\" /ve /t REG_SZ /d \"{1bca9901-05c3-4d01-8ad4-78da2eac9b3f}\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\" /ve /t REG_SZ /d \"ICMiDropContextMenuExt\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\\ProxyStubClsid32\" /ve /t REG_SZ /d \"{00020424-0000-0000-C000-000000000046}\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\\TypeLib\" /ve /t REG_SZ /d \"{879EC5C6-6C77-4EC5-9725-9096DF0AA7BA}\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\\TypeLib\" /v \"Version\" /t REG_SZ /d \"1.0\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\TypeLib\\{879EC5C6-6C77-4EC5-9725-9096DF0AA7BA}\\1.0\" /ve /t REG_SZ /d \"MiDropShellExtLib\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\TypeLib\\{879EC5C6-6C77-4EC5-9725-9096DF0AA7BA}\\1.0\\0\\win64\" /ve /t REG_SZ /d \"$dir\\$version\\MiDropShellExt.dll\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\TypeLib\\{879EC5C6-6C77-4EC5-9725-9096DF0AA7BA}\\1.0\\FLAGS\" /ve /t REG_SZ /d \"0\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\TypeLib\\{879EC5C6-6C77-4EC5-9725-9096DF0AA7BA}\\1.0\\HELPDIR\" /ve /t REG_SZ /d \"$dir\\$version\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\Wow6432Node\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\" /ve /t REG_SZ /d \"ICMiDropContextMenuExt\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\Wow6432Node\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\\ProxyStubClsid32\" /ve /t REG_SZ /d \"{00020424-0000-0000-C000-000000000046}\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\Wow6432Node\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\\TypeLib\" /ve /t REG_SZ /d \"{879EC5C6-6C77-4EC5-9725-9096DF0AA7BA}\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Classes\\Wow6432Node\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\\TypeLib\" /v \"Version\" /t REG_SZ /d \"1.0\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\XiaomiPcManager.exe\" /ve /t REG_SZ /d \"$dir\\$version\\XiaomiPcManager.exe\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\XiaomiPcManager.exe\" /v \"channel\" /t REG_SZ /d \"preload\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\XiaomiPcManager.exe\" /v \"Path\" /t REG_SZ /d \"$dir\\$version\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\XiaomiPcManager.exe\" /v \"Version\" /t REG_SZ /d \"$version\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"小米电脑管家\" /t REG_SZ /d \"$dir\\Launch.exe --AutoRun=1\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\XiaomiPCManager\" /v \"CurrentMainVersion\" /t REG_SZ /d \"$version\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\XiaomiPCManager\" /v \"DisplayIcon\" /t REG_SZ /d \"$dir\\$version\\Uninstall.exe\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\XiaomiPCManager\" /v \"DisplayName\" /t REG_SZ /d \"小米电脑管家\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\XiaomiPCManager\" /v \"DisplayVersion\" /t REG_SZ /d \"$version\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\XiaomiPCManager\" /v \"Publisher\" /t REG_SZ /d \"小米科技有限责任公司\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\XiaomiPCManager\" /v \"UninstallString\" /t REG_SZ /d \"$dir\\$version\\Uninstall.exe\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Xiaomi\\__idm__\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\dist_service\" /v \"DisplayName\" /t REG_SZ /d \"XiaoMi Dist Service\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\dist_service\" /v \"ErrorControl\" /t REG_DWORD /d \"1\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\dist_service\" /v \"FailureActions\" /t REG_BINARY /d \"FFFFFFFF000000000000000001000000140000000100000088130000\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\dist_service\" /v \"ImagePath\" /t REG_EXPAND_SZ /d \"`\"$dir\\$version\\dist_service.exe`\"\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\dist_service\" /v \"ObjectName\" /t REG_SZ /d \"LocalSystem\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\dist_service\" /v \"Start\" /t REG_DWORD /d \"2\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\dist_service\" /v \"Type\" /t REG_DWORD /d \"16\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DistributedService\" /v \"DisplayName\" /t REG_SZ /d \"XiaoMi Distributed Service\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DistributedService\" /v \"ErrorControl\" /t REG_DWORD /d \"1\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DistributedService\" /v \"FailureActions\" /t REG_BINARY /d \"FFFFFFFF000000000000000001000000140000000100000088130000\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DistributedService\" /v \"ImagePath\" /t REG_EXPAND_SZ /d \"`\"$dir\\$version\\DistributedService.exe`\"\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DistributedService\" /v \"ObjectName\" /t REG_SZ /d \"LocalSystem\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DistributedService\" /v \"Start\" /t REG_DWORD /d \"2\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DistributedService\" /v \"Type\" /t REG_DWORD /d \"16\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\handoff_service\" /v \"DisplayName\" /t REG_SZ /d \"XiaoMi Handoff Service\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\handoff_service\" /v \"ErrorControl\" /t REG_DWORD /d \"1\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\handoff_service\" /v \"FailureActions\" /t REG_BINARY /d \"FFFFFFFF000000000000000001000000140000000100000088130000\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\handoff_service\" /v \"ImagePath\" /t REG_EXPAND_SZ /d \"`\"$dir\\$version\\handoff\\handoff_svc.exe`\"\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\handoff_service\" /v \"ObjectName\" /t REG_SZ /d \"LocalSystem\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\handoff_service\" /v \"Start\" /t REG_DWORD /d \"2\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\handoff_service\" /v \"Type\" /t REG_DWORD /d \"16\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /v \"DependOnService\" /t REG_MULTI_SZ /d \"RPCSS\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /v \"Description\" /t REG_SZ /d \"小米AIoT服务框架\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /v \"DisplayName\" /t REG_SZ /d \"MAFSvr\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /v \"ErrorControl\" /t REG_DWORD /d \"0\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /v \"FailureActions\" /t REG_BINARY /d \"FFFFFFFF000000000000000001000000140000000100000060EA0000\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /v \"ImagePath\" /t REG_EXPAND_SZ /d \"`\"$dir\\$version\\MAFSvr.exe`\"\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /v \"ObjectName\" /t REG_SZ /d \"LocalSystem\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /v \"Start\" /t REG_DWORD /d \"2\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /v \"Type\" /t REG_DWORD /d \"16\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\micont_service\" /v \"DisplayName\" /t REG_SZ /d \"XiaoMi Continuity Service\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\micont_service\" /v \"ErrorControl\" /t REG_DWORD /d \"1\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\micont_service\" /v \"FailureActions\" /t REG_BINARY /d \"FFFFFFFF000000000000000001000000140000000100000088130000\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\micont_service\" /v \"ImagePath\" /t REG_EXPAND_SZ /d \"`\"$dir\\$version\\micont_service.exe`\"\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\micont_service\" /v \"ObjectName\" /t REG_SZ /d \"LocalSystem\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\micont_service\" /v \"Start\" /t REG_DWORD /d \"2\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\micont_service\" /v \"Type\" /t REG_DWORD /d \"16\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MiPlayCastService\" /v \"Description\" /t REG_SZ /d \"小米MiPlay服务框架\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MiPlayCastService\" /v \"DisplayName\" /t REG_SZ /d \"MiPlayCastService\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MiPlayCastService\" /v \"ErrorControl\" /t REG_DWORD /d \"1\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MiPlayCastService\" /v \"FailureActions\" /t REG_BINARY /d \"FFFFFFFF000000000000000001000000140000000100000060EA0000\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MiPlayCastService\" /v \"ImagePath\" /t REG_EXPAND_SZ /d \"$dir\\$version\\MiPlayCastService.exe\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MiPlayCastService\" /v \"ObjectName\" /t REG_SZ /d \"LocalSystem\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MiPlayCastService\" /v \"Start\" /t REG_DWORD /d \"2\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MiPlayCastService\" /v \"Type\" /t REG_DWORD /d \"16\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{07C67717-D10C-4910-B8EE-DADF8E45CCAF}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=6|App=$dir\\$version\\MiScreenShare.exe|Name=MiScreenShare|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{096D405A-7B6C-48C9-AD91-9B538F5E0209}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=6|App=$dir\\$version\\XiaomiPcManager.exe|Name=MiSmartShare|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{11C2D9C4-04A8-46FD-B4E2-6D03EB8AC6B4}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=6|App=$dir\\$version\\MAFSvr.exe|Name=MAFSvr|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{12030C52-FCBA-4F36-B873-547DA021280F}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=17|App=$dir\\$version\\micont_service.exe|Name=micont_service|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{1B60D6DF-4812-4C8C-B5E7-EDF27A04E5B8}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=17|App=$dir\\$version\\MiScreenShare.exe|Name=MiScreenShare|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{1BE59DAF-B2EB-46A3-9B42-73DAC88334DA}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=6|App=$dir\\$version\\MiPCAudio.exe|Name=MiPCAudio|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{29B9D598-E60B-4A3E-B3E7-59A4DB9E826D}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=6|App=$dir\\$version\\MiPlayCastService.exe|Name=MiPlayCastService|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{53ADF203-64FE-4951-9763-AD1E3F3E7096}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=17|App=$dir\\$version\\dist_service.exe|Name=dist_service|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{5E425ED7-944C-4581-B41A-8A04C13E7677}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=17|App=$dir\\$version\\MiPlayCastService.exe|Name=MiPlayCastService|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{6C692B32-A1D8-4CA0-9415-10BC9E768F90}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=17|App=$dir\\$version\\MAFSvr.exe|Name=MAFSvr|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{76DF124F-1E7A-412E-BAB0-53ABBFBE68F5}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=6|App=$dir\\$version\\dist_service.exe|Name=dist_service|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{774624A9-449B-487F-A8EE-1B7FC6780941}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=6|App=$dir\\$version\\XiaomiPcManager.exe|Name=MiSmartShare|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{792FFBCA-C34F-46F9-9F21-D03BEA8F7A6C}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=17|App=$dir\\$version\\micont_service.exe|Name=micont_service|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{7B758E1C-EBA4-460F-BA27-2AE977AC5752}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=17|App=$dir\\$version\\MiScreenShare.exe|Name=MiScreenShare|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{7D736101-91E2-469E-AE84-E55C45855DCE}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=17|App=$dir\\$version\\XiaomiPcManager.exe|Name=MiSmartShare|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{83315919-7555-42D0-A502-C25BBE4F26B4}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=6|App=$dir\\$version\\MiPlayCastService.exe|Name=MiPlayCastService|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{86252C5C-FEE1-4074-BCB4-4E3DEC15888E}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=6|App=$dir\\$version\\DistributedService.exe|Name=DistributedService|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{8BD15F5A-192E-4DFF-88A2-8548188263F2}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=17|App=$dir\\$version\\MAFSvr.exe|Name=MAFSvr|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{901B2E1E-C873-4D77-A48A-AFAABFAE5711}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=6|App=$dir\\$version\\micont_service.exe|Name=micont_service|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{90721B1A-B0EE-40E9-A73E-DA08FF7B42C3}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=17|App=$dir\\$version\\XiaomiPcManager.exe|Name=MiSmartShare|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{972C306D-0F9E-442C-A79D-CFCA06F43D9B}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=6|App=$dir\\$version\\MiPCAudio.exe|Name=MiPCAudio|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{99CA5085-7064-4569-95C1-36B756C4815D}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=6|App=$dir\\$version\\MiScreenShare.exe|Name=MiScreenShare|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{A12FF6E4-04F2-4E55-98AF-1EAB158F8964}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=17|App=$dir\\$version\\DistributedService.exe|Name=DistributedService|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{A928ACD2-2ECA-44B8-8111-75CF8118FD68}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=6|App=$dir\\$version\\micont_service.exe|Name=micont_service|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{AB33282C-2114-4E88-8DBE-D9B88F5CB06A}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=17|App=$dir\\$version\\DistributedService.exe|Name=DistributedService|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{AD267E97-AB17-4D21-876D-686EA795DEBE}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=6|App=$dir\\$version\\dist_service.exe|Name=dist_service|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{AD932D90-F1F8-4231-BADC-7DE580DAE78E}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=6|App=$dir\\$version\\DistributedService.exe|Name=DistributedService|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{E589588B-BC6E-41CC-AC45-D6D1CCEDA71D}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=17|App=$dir\\$version\\MiPCAudio.exe|Name=MiPCAudio|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{E704DC0F-456B-4BD0-82EF-2336DAC2BE26}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=17|App=$dir\\$version\\dist_service.exe|Name=dist_service|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{F3BE329E-D5DE-4D3D-8052-DC9BCD4F4AE1}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=17|App=$dir\\$version\\MiPlayCastService.exe|Name=MiPlayCastService|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{F3CA2F5B-2185-4891-AC84-CB6EB7764BB1}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=In|Protocol=6|App=$dir\\$version\\MAFSvr.exe|Name=MAFSvr|\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{F927A5DC-176A-4768-9B3D-D8CC96B2C53F}\" /t REG_SZ /d \"v2.30|Action=Allow|Active=TRUE|Dir=Out|Protocol=17|App=$dir\\$version\\MiPCAudio.exe|Name=MiPCAudio|\" /f",
            "reg.exe add \"HKCU\\SOFTWARE\\Classes\\CLSID\\{0F6603C8-3E81-452C-9C39-7312582DCDEE}\\LocalServer32\" /ve /t REG_SZ /d \"$dir\\Launch.exe -ToastActivated\" /f",
            "reg.exe add \"HKCU\\SOFTWARE\\MI\\XiaomiPCManager\" /v \"FirstOpenControlCenterFlag\" /t REG_SZ /d \"False\" /f",
            "reg.exe add \"HKCU\\SOFTWARE\\MI\\XiaomiPCManager\" /v \"TrayPath\" /t REG_SZ /d \"\" /f",
            "reg.exe add \"HKCU\\SOFTWARE\\MI\\XiaomiPCManager\" /v \"winevent_bookmark\" /t REG_SZ /d \"<BookmarkList><Bookmark Channel='Application' RecordId='0'/> <Bookmark Channel='System' RecordId='0' IsCurrent='true'/> </BookmarkList>\" /f",
            ". \"$dir\\$version\\Driver_Install.cmd\"",
            "pnputil.exe /add-driver \"$dir\\$version\\RadioControl.inf\" /install",
            ". \"$dir\\$version\\FixServiceTool.exe\"",
            "Write-Host \"Please restart your computer to install $app properly\" -F 'Red'"
        ]
    },
    "shortcuts": [
        [
            "Launch.exe",
            "小米电脑管家"
        ]
    ],
    "pre_uninstall": [
        "if (!(is_admin)) {",
        "    error \"Administrator rights are required to uninstall $app.\"",
        "    exit 1",
        "}",
        "$bucket = $install.bucket",
        ". \"$bucketsdir\\$bucket\\bin\\utils.ps1\"",
        "Stop-App"
    ],
    "uninstaller": {
        "script": [
            "if ($cmd -eq 'uninstall') {",
            ". \"$dir\\$version\\Driver_Uninstall.cmd\"",
            "pnputil.exe /delete-driver \"$dir\\$version\\RadioControl.inf\" /force",
            ". \"$dir\\$version\\uninstall_dmft.bat\"",
            "reg.exe delete \"HKLM\\SOFTWARE\\Classes\\*\\shellex\\ContextMenuHandlers\\MiDropExtMenu\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Classes\\AppID\\{846d36ff-1cb4-4d2c-8d90-b292f8b5a1d0}\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Classes\\CLSID\\{1bca9901-05c3-4d01-8ad4-78da2eac9b3f}\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Classes\\Directory\\shellex\\ContextMenuHandlers\\MiDropExtMenu\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Classes\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Classes\\TypeLib\\{879EC5C6-6C77-4EC5-9725-9096DF0AA7BA}\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Classes\\Wow6432Node\\Interface\\{AE6A8E5E-A300-47BE-B2B4-1BA56E9C60CF}\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Microsoft\\Tracing\\XiaomiPcManager_RASAPI32\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Microsoft\\Tracing\\XiaomiPcManager_RASMANCS\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\XiaomiPcManager.exe\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"小米电脑管家\" /f",
            "reg.exe add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\XiaomiPCManager\" /f",
            "reg.exe delete \"HKLM\\SOFTWARE\\Xiaomi\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\dist_service\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DistributedService\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\handoff_service\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MAFSvr\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\micont_service\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MiPlayCastService\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{07C67717-D10C-4910-B8EE-DADF8E45CCAF}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{096D405A-7B6C-48C9-AD91-9B538F5E0209}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{11C2D9C4-04A8-46FD-B4E2-6D03EB8AC6B4}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{12030C52-FCBA-4F36-B873-547DA021280F}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{1B60D6DF-4812-4C8C-B5E7-EDF27A04E5B8}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{1BE59DAF-B2EB-46A3-9B42-73DAC88334DA}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{29B9D598-E60B-4A3E-B3E7-59A4DB9E826D}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{53ADF203-64FE-4951-9763-AD1E3F3E7096}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{5E425ED7-944C-4581-B41A-8A04C13E7677}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{6C692B32-A1D8-4CA0-9415-10BC9E768F90}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{76DF124F-1E7A-412E-BAB0-53ABBFBE68F5}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{774624A9-449B-487F-A8EE-1B7FC6780941}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{792FFBCA-C34F-46F9-9F21-D03BEA8F7A6C}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{7B758E1C-EBA4-460F-BA27-2AE977AC5752}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{7D736101-91E2-469E-AE84-E55C45855DCE}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{83315919-7555-42D0-A502-C25BBE4F26B4}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{86252C5C-FEE1-4074-BCB4-4E3DEC15888E}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{8BD15F5A-192E-4DFF-88A2-8548188263F2}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{901B2E1E-C873-4D77-A48A-AFAABFAE5711}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{90721B1A-B0EE-40E9-A73E-DA08FF7B42C3}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{972C306D-0F9E-442C-A79D-CFCA06F43D9B}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{99CA5085-7064-4569-95C1-36B756C4815D}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{A12FF6E4-04F2-4E55-98AF-1EAB158F8964}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{A928ACD2-2ECA-44B8-8111-75CF8118FD68}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{AB33282C-2114-4E88-8DBE-D9B88F5CB06A}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{AD267E97-AB17-4D21-876D-686EA795DEBE}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{AD932D90-F1F8-4231-BADC-7DE580DAE78E}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{E589588B-BC6E-41CC-AC45-D6D1CCEDA71D}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{E704DC0F-456B-4BD0-82EF-2336DAC2BE26}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{F3BE329E-D5DE-4D3D-8052-DC9BCD4F4AE1}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{F3CA2F5B-2185-4891-AC84-CB6EB7764BB1}\" /f",
            "reg.exe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /v \"{F927A5DC-176A-4768-9B3D-D8CC96B2C53F}\" /f",
            "reg.exe add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\" /f",
            "reg.exe delete \"HKCU\\SOFTWARE\\Classes\\CLSID\\{0F6603C8-3E81-452C-9C39-7312582DCDEE}\" /f",
            "reg.exe delete \"HKCU\\SOFTWARE\\MI\\XiaomiPCManager\" /f",
            "Write-Host \"Please restart your computer to uninstall $app properly\" -F 'Red'",
            "}"
        ]
    },
    "checkver": {
        "regex": "<a href=\"(?<url>https://.+XiaomiPCManager_hyperos2_([\\d.]+)_\\w+\\.exe)"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "$matchUrl#/installer.exe"
            }
        }
    }
}
