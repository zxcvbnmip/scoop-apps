{
    "version": "12.1.0.19768",
    "description": "WPS Office 一站式办公服务平台 新升级，无广告，AI办公更高效",
    "homepage": "https://www.wps.cn/",
    "license": {
        "identifier": "Copyright © 2008-2023 Kingsoft Office , All Rights Reserved.",
        "url": "https://www.wps.cn/privacy/full_account/"
    },
    "notes": "手动调用配置工具安装，不保证能用",
    "architecture": {
        "64bit": {
            "url": "https://official-package.wpscdn.cn/wps/download/WPS_Setup_X64_19768.exe",
            "hash": "7bb4691a169cd6bb2273bfce8263bd64981d39bfd4cd178184469220a38d470f"
        }
    },
    "shortcuts": [
        [
            "office6\\wpsoffice.exe",
            "WPS Office"
        ]
    ],
    "installer": {
        "script": [
            "Expand-7zipArchive \"$dir\\$fname\" -Removal",
            "Expand-7zipArchive \"$dir\\`$_11_\\`$EXEFILE\" -Switches '-t#'",
            "Move-Item \"$dir\\`$_11_\\*.7z\" \"$dir\" -ErrorAction SilentlyContinue | Out-Null",
            "Remove-Item \"$dir\\*\" -Exclude '4.7z', '2.7z' -Recurse -ErrorAction SilentlyContinue | Out-Null",
            "Expand-7zipArchive \"$dir\\2.7z\" -ExtractDir 'CONTROL\\office6' -ExtractDir \"$dir\\office6\" -Removal",
            "Expand-7zipArchive \"$dir\\4.7z\" -ExtractDir 'office6' -ExtractDir \"$dir\\office6\" -Removal",
            "",
            ". \"$dir\\office6\\ksomisc.exe\" -kccmove",
            ". \"$dir\\office6\\ksomisc.exe\" -fixoldversionassostatus",
            ". \"$dir\\office6\\ksomisc.exe\" -addFirewallRule",
            ". \"$dir\\office6\\ksomisc.exe\" -setservers",
            ". \"$dir\\office6\\ksomisc.exe\" -register",
            ". \"$dir\\office6\\ksomisc.exe\" -regmtfont",
            ". \"$dir\\office6\\ksomisc.exe\" -setappcap",
            ". \"$dir\\office6\\ksomisc.exe\" -regprogid true",
            ". \"$dir\\office6\\ksomisc.exe\" -assobyext",
            ". \"$dir\\office6\\ksomisc.exe\" -assowordexcelpowerpnt",
            ". \"$dir\\office6\\ksomisc.exe\" -compatiblemso",
            ". \"$dir\\office6\\ksomisc.exe\" -checkcompatiblemso",
            ". \"$dir\\office6\\ksomisc.exe\" -saveas_mso",
            ". \"$dir\\office6\\ksomisc.exe\" -updatesaveto",
            "# . \"$dir\\office6\\ksomisc.exe\" -distsrc 000",
            "# . \"$dir\\office6\\ksomisc.exe\" -sendinstalldyn",
            "# . \"$dir\\office6\\ksomisc.exe\" -createlink startmenu",
            "# . \"$dir\\office6\\ksomisc.exe\" -updatetaskbarpin",
            ". \"$dir\\office6\\ksomisc.exe\" -addcontextmenushellnew",
            ". \"$dir\\office6\\ksomisc.exe\" -regvascontextmenushellnew",
            ". \"$dir\\office6\\ksomisc.exe\" -regkwpsshellext admin",
            "# . \"$dir\\office6\\ksomisc.exe\" -regyunpan",
            "# . \"$dir\\office6\\ksomisc.exe\" -regqingdriveshellext_install",
            "# . \"$dir\\office6\\ksomisc.exe\" -Assopdf",
            ". \"$dir\\office6\\ksomisc.exe\" -setappcap",
            "# . \"$dir\\office6\\ksomisc.exe\" -assoepub",
            ". \"$dir\\office6\\ksomisc.exe\" -assofdf",
            "# . \"$dir\\office6\\ksomisc.exe\" -createsubmodulelink startmenu pdf",
            "# . \"$dir\\office6\\ksomisc.exe\" -createsubmodulelink desktop cloudusbdrive",
            "# . \"$dir\\office6\\ksomisc.exe\" -externaltask create",
            "# . \"$dir\\office6\\ksomisc.exe\" -createsubmodulelink desktop prometheus",
            "# . \"$dir\\office6\\ksomisc.exe\" -createsubmodulelink startmenu prometheus",
            "# . \"$dir\\office6\\ksomisc.exe\" -createlink desktop",
            "# WriteReg -key=Software\\Kingsoft\\Office\\6.0\\Common\\category -type=string -value=personal",
            ". \"$dir\\office6\\ksomisc.exe\" -clearmso2pdfplugins",
            ". \"$dir\\office6\\ksomisc.exe\" -cleardocermsoplugins",
            "# . \"$dir\\office6\\ksomisc.exe\" -assopic",
            "# . \"$dir\\office6\\photolaunch.exe\" -createlink",
            ". \"$dir\\office6\\ksomisc.exe\" -assoofd",
            ". \"$dir\\office6\\ksomisc.exe\" -assoopg",
            "# . \"$dir\\office6\\ksomisc.exe\" -regcadfileasso",
            "# . \"$dir\\office6\\ksomisc.exe\" -regarchivefileasso",
            "# . \"$dir\\office6\\ksomisc.exe\" -installbrowserextensionhost",
            "# . \"$dir\\office6\\ksomisc.exe\" -regvideoeditsetupfileasso",
            ". \"$dir\\office6\\ksomisc.exe\" -regemmxfileasso",
            ". \"$dir\\office6\\ksomisc.exe\" -regeddxfileasso",
            "# . \"$dir\\office6\\ksomisc.exe\" -uninstalldatarecover",
            "# . \"$dir\\office6\\ksomisc.exe\" -updatelinkIcon 15 repairAppIcon",
            ". \"$dir\\office6\\ksomisc.exe\" -repair3rdlink",
            "# . \"$dir\\office6\\ksomisc.exe\" -createexternstartmenu \"$STARTMENU$\"",
            ". \"$dir\\office6\\ksomisc.exe\" -rebuildicon",
            ". \"$dir\\office6\\ksomisc.exe\" -addJsapiCert",
            "",
            "@\"",
            "Windows Registry Editor Version 5.00",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\Common\\kic\\switch\\notify]",
            "\"FtJNUj1Xt6rGUkBGNcM/nQ==\"=\"tIzQW1Kz6mwlP6dqFyP+4A==\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\Common\\kic\\switch\\user]",
            "\"qA32MuVupIR0D+2e/hYicA==\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "\"jTQDZ60PH0TgGVc5XPR/PU7FlhQ8sfv+Ir0usxuF3ZU=\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "\"uWEXwvpGEA0DSF5Ae3PdqUF1uYEKqK0txnQophtU3m4=\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "\"6GjQUxiYYdH8NxOVJUdpOAjJeIHv/0n3dzAUyF0tGYo=\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "\"qssOqcEcuBksgfkgNmgDpW3dpPs4ssTllPQRRIC7smA=\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "\"VSXFEuhyZ+7MHjXCpG0+tBIZpYyWuOAgJbjlxkCYroM=\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "\"pyoJeTexMJjB7c+B5ylpHt+wVeomk+s2MWuw1Y4FoIg=\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "\"PMMpgkp8ls/4qfEiWKL9gvL4eyv2r9wg2ea0HbDpK48=\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "\"kaQm19O36bskO7uwj2PeAJN5951KEClWCpFJR5RHyJs=\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "\"acDkBNIdhqvnq4dBKpXAHPoIu0Zp53bEPEBHr+J7KWE=\"=\"+aeeBtbOq05m3PRsQJoXMg==\"",
            "",
            "[HKEY_CURRENT_USER\\Software\\kingsoft\\Office\\6.0\\Common\\ksomisc]",
            "\"VasContextMenuShellNewUser\"=\"false\"",
            "",
            "[HKEY_CURRENT_USER\\Software\\kingsoft\\Office\\6.0\\Common\\proxyinfo]",
            "\"proxytype\"=dword:00000000",
            "",
            "[HKEY_CURRENT_USER\\Software\\kingsoft\\Office\\6.0\\Common\\updateinfo]",
            "\"UpdateMode\"=\"auto\"",
            ";\"UpdateMode\"=\"manual\"",
            "\"showadinf\"=\"0\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\WPSCloud]",
            "\"DesktopSync\"=\"false\"",
            "\"EnableVirtualCloudDisk\"=\"false\"",
            "\"autorunTrayLastOperation\"=\"close\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\WPSCloud\\usercenter\\tray]",
            "\"TrayStartWithWpsStart\"=\"false\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\WPSCloud\\usercenter\\all\\wpsbox]",
            "\"myAddBoot\"=\"false\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\WPSCloud\\userinfo]",
            "\"forceLoginState\"=\"false\"",
            "",
            "[HKEY_CURRENT_USER\\Software\\Kingsoft\\Office\\6.0\\Common]",
            "\"AcceptedEULA\"=\"true\"",
            "\"autoSwitchSkin\"=\"false\"",
            "\"usingGaussianBlur\"=dword:00000001 ; WPS365 ENABLE BLUR",
            "\"lastestGaussianBlurEnable\"=dword:00000001 ; WPS365 ENABLE BLUR",
            "\"EnableNewDocerMall\"=\"false\"",
            "\"first_detect_file_association_while_startup\"=\"false\"",
            "\"do_not_detect_file_association_while_startup\"=\"true\"",
            "\"FirstInstall\"=\"0\"",
            "\"disableGlobalInfoCollect\"=\"1\"",
            "\"newGuideShow\"=\"1\"",
            "\"disablecustomconfigure\"=-",
            "",
            "[HKEY_CURRENT_USER\\Software\\kingsoft\\Office\\6.0\\plugins\\photo]",
            "\"NeedAsso\"=\"0\"",
            "\"canShowRightTopTips\"=\"false\"",
            "\"showAppcenterTips\"=\"false\"",
            "",
            "[HKEY_CURRENT_USER\\Software\\kingsoft\\Office\\6.0\\plugins\\photo\\asso]",
            "\"assoTipsShowTime\"=\"2038.12.12\"",
            "\"assoTipsNoPrompt\"=\"true\"",
            "",
            "[HKEY_CURRENT_USER\\Software\\Kingsoft\\Office\\6.0\\plugins\\kskincenter]",
            "\"followSystem\"=\"true\"",
            "",
            "[HKEY_CURRENT_USER\\Software\\Kingsoft\\Office\\6.0\\plugins\\officespace\\flogin]",
            "\"userPaneShowed\"=\"1\"",
            "\"enableForceLoginStyle_202111\"=\"false\"",
            "\"enableForceLoginForFirstInstallDevice\"=\"false\"",
            "\"StartupNoticeShow\"=\"true\"",
            "\"lastSkipGuideLoginTime\"=hex(b):18,88,48,fe,f3,01,00,00",
            "",
            ";[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\plugins\\ksomisc]",
            ";\"cancelassopdf\"=\"1\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\plugins\\officespace\\loginwin]",
            "\"loginwin\"=dword:00000000",
            "\"loginwin_parent\"=dword:00000000",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\plugins\\officespace\\loginwin\\new]",
            "\"need_show_gift\"=dword:00000000",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\plugins\\kstartpage\\styleMode]",
            "\"hideTextMode\"=\"true\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\plugins\\kstartpage\\officenav_new_v1\\custEntry]",
            "\"docershop\"=\"false\"",
            "\"docerlibrary\"=\"false\"",
            "\"docerchuangkit\"=\"false\"",
            "\"kteamoffice\"=\"false\"",
            "",
            "[-HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\plugins\\kstartpage\\officenav_new_v1\\seqEntry\\AppcenterEntrys]",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\plugins\\kdocerpage]",
            "\"docerTabShow\"=dword:00000000",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\plugins\\kcdiskclean]",
            "\"wpsSceneRecEnable\"=\"false\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\kwpsshellext]",
            "\"disableDocPropPage\"=dword:00000001",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\kwpsshellext\\contextmenu\\photo]",
            "\"supportedit\"=\"false\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\kpacket]",
            "\"udaa\"=\"true\"",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\kingsoft\\Office\\6.0\\plugins\\kicontheme]",
            "\"IconThemeName\"=\"icontheme2023spring\"",
            "\"AppliedFromSkinCenter\"=\"true\"",
            "",
            "[HKEY_CURRENT_USER\\Software\\kingsoft\\Office\\6.0\\pdf\\Application Settings]",
            "\"SaveLastPosition\"=dword:00000001",
            "\"IsUseLastCloseCursorType\"=dword:00000000",
            "\"GlobalCursorSelectType\"=dword:00000001",
            ";\"HidePageGap\"=dword:00000001",
            ";\"FitMode\"=dword:00000002",
            ";\"DisplayMode\"=dword:00000000",
            "",
            "[HKEY_CURRENT_USER\\Software\\kingsoft\\Office\\6.0\\wps\\Application Settings]",
            "\"ShowWhat\"=\"217\"",
            "\"ShowEscChar\"=\"191\"",
            ";\"AutoFormatAsYouTypeApplyNumberedLists\"=\"0\"",
            ";\"AutoCircleNumber\"=\"0\"",
            "",
            "[-HKEY_CLASSES_ROOT\\.pdfwpsshellnew]",
            "",
            "[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run]",
            "\"KWpsBox\"=-",
            "\"wpsphotoautoasso\"=-",
            "",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\*\\ShellEx\\ContextMenuHandlers\\Open With kwpsshellext]",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\*\\ShellEx\\ContextMenuHandlers\\Open With qingshellext]",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\*\\ShellEx\\ContextMenuHandlers\\QingNseContextMenu]",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\Directory\\ShellEx\\ContextMenuHandlers\\Open With kwpsshellext]",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\Directory\\ShellEx\\ContextMenuHandlers\\Open With qingshellext]",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\Directory\\ShellEx\\ContextMenuHandlers\\QingNseContextMenu]",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\Directory\\ShellEx\\ContextMenuHandlers\\qkdesktopshellext]",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\ShellEx\\ContextMenuHandlers\\Open With kwpsshellext]",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\ShellEx\\ContextMenuHandlers\\Open With qingshellext]",
            "[-HKEY_CURRENT_USER\\Software\\Classes\\Directory\\Background\\ShellEx\\ContextMenuHandlers\\QingNseContextMenu]",
            "[-HKEY_CURRENT_USER\\SOFTWARE\\Classes\\Directory\\shellex\\CopyHookHandlers\\WPSDriveCopyHook]",
            "\"@ | Set-Content \"$dir\\tweak.reg\" -Encoding unicode",
            "",
            "reg.exe import \"$dir\\tweak.reg\""
        ]
    },
    "uninstaller": {
        "script": [
            ". \"$dir\\office6\\ksomisc.exe\" -unregistermessagepush",
            "# . \"$dir\\office6\\ksomisc.exe\" -sendinstalldyn",
            "# . \"$dir\\office6\\ksomisc.exe\" -deletelink quicklaunch",
            "# . \"$dir\\office6\\ksomisc.exe\" -deletelink desktop",
            "# . \"$dir\\office6\\ksomisc.exe\" -deletelink desktop -forceperusermode",
            "# . \"$dir\\office6\\ksomisc.exe\" -deletelink startmenu \"WPS Office\"",
            "# . \"$dir\\office6\\ksomisc.exe\" -deletelink startmenu \"WPS Office 个人版\"",
            "# . \"$dir\\office6\\ksomisc.exe\" -deletelink startmenu \"WPS Office 个人版 抢鲜版\"",
            "# . \"$dir\\office6\\ksomisc.exe\" -deletelink startmenu \"WPS Office 新春版\"",
            "# . \"$dir\\office6\\ksomisc.exe\" -deletelink startmenu \"WPS Office 抢鲜版\"",
            "# . \"$dir\\office6\\ksomisc.exe\" -deletetaskbarpin -forceperusermode",
            ". \"$dir\\office6\\ksomisc.exe\" -unregkwpsshellext admin",
            ". \"$dir\\office6\\ksomisc.exe\" -unregqingdriveshellext_uninstall",
            ". \"$dir\\office6\\ksomisc.exe\" -regpcddriver_uninstall",
            ". \"$dir\\office6\\ksomisc.exe\" -unregyunpan -forceperusermode",
            ". \"$dir\\office6\\ksomisc.exe\" -externaltask delete",
            ". \"$dir\\office6\\ksomisc.exe\" -uncompatiblemso",
            ". \"$dir\\office6\\ksomisc.exe\" -unassoword",
            ". \"$dir\\office6\\ksomisc.exe\" -unassopowerpnt",
            ". \"$dir\\office6\\ksomisc.exe\" -unassoexcel",
            ". \"$dir\\office6\\ksomisc.exe\" -unassopdf",
            ". \"$dir\\office6\\ksomisc.exe\" -unassoepub",
            ". \"$dir\\office6\\ksomisc.exe\" -unassofdf",
            ". \"$dir\\office6\\ksomisc.exe\" -unassopic_uninstall",
            ". \"$dir\\office6\\ksomisc.exe\" -unregarchivefileasso",
            ". \"$dir\\office6\\ksomisc.exe\" -unsetappcap",
            ". \"$dir\\office6\\ksomisc.exe\" -unregprogid",
            ". \"$dir\\office6\\ksomisc.exe\" -unregister",
            ". \"$dir\\office6\\ksomisc.exe\" -unregPreviewHandler",
            ". \"$dir\\office6\\ksomisc.exe\" -unregksee -forceperusermode",
            ". \"$dir\\office6\\WPSOfficePIA.exe\" /RegDotNetDll=0",
            ". \"$dir\\office6\\ksomisc.exe\" -unassoofficexml",
            ". \"$dir\\office6\\ksomisc.exe\" -unregmtfont",
            ". \"$dir\\office6\\ksomisc.exe\" -unassoofd",
            ". \"$dir\\office6\\ksomisc.exe\" -unassoopg",
            ". \"$dir\\office6\\ksomisc.exe\" -unregcadfileasso",
            ". \"$dir\\office6\\ksomisc.exe\" -unregvideoeditfileasso",
            ". \"$dir\\office6\\ksomisc.exe\" -unregemmxfileasso",
            ". \"$dir\\office6\\ksomisc.exe\" -unregeddxfileasso",
            ". \"$dir\\office6\\ksomisc.exe\" -unregvascontextmenushellnew",
            ". msiexec.exe /q /x \"{5545EEE5-FA36-4F76-B6BE-5696E7F4E2D6}\"",
            ". \"$dir\\office6\\ksomisc.exe\" -unregmso2pdfplugins",
            ". \"$dir\\office6\\ksomisc.exe\" -unreghtml2PdfPlugins",
            ". \"$dir\\office6\\ksomisc.exe\" -rebuildicon",
            ". \"$dir\\office6\\ksomisc.exe\" -clearCustomDestList",
            ". \"$dir\\office6\\ksomisc.exe\" -delJsapiCert",
            "if ($cmd -eq 'uninstall') {",
            "    Remove-Item \"$env:LocalAppData\\kingsoft\\WPS Cloud Files\" -Recurse -Force -ErrorAction SilentlyContinue | Out-Null",
            "    Remove-Item \"$env:AppData\\kingsoft\\WPS Cloud Files\" -Recurse -Force -ErrorAction SilentlyContinue | Out-Null",
            "    Remove-Item \"$env:AppData\\kingsoft\\kaccountsdk\" -Recurse -Force -ErrorAction SilentlyContinue | Out-Null",
            "    Remove-Item \"$env:AppData\\kingsoft\\kdynsdk\" -Recurse -Force -ErrorAction SilentlyContinue | Out-Null",
            "    Remove-Item \"$env:AppData\\kingsoft\\kaccooffice6ntsdk\" -Recurse -Force -ErrorAction SilentlyContinue | Out-Null",
            "    Remove-Item \"$env:AppData\\kingsoft\\qing\" -Recurse -Force -ErrorAction SilentlyContinue | Out-Null",
            "    Remove-Item \"$env:AppData\\kingsoft\\wps\" -Recurse -Force -ErrorAction SilentlyContinue | Out-Null",
            "    reg.exe delete HKCU\\SOFTWARE\\Kingsoft /f",
            "}"
        ]
    },
    "checkver": {
        "url": "https://www.wps.cn/platformUrlsv2",
        "jsonpath": "$.productList[?(@.productName == 'WPS Office for beta')].productVcode"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://official-package.wpscdn.cn/wps/download/WPS_Setup_X64_$buildVersion.exe"
            }
        }
    }
}
